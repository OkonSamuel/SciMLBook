<h1 class=title >Ordinary Differential Equations, Applications and Discretizations</h1> <h5>Chris Rackauckas</h5> <h5>October 1st, 2020</h5> <h2><a href="https://youtu.be/riAbPZy9gFc">Youtube Video Link Part 1</a></h2> <h2><a href="https://youtu.be/HMmOk9GIhsw">Youtube Video Link Part 2</a></h2> <p>Now that we have a sense of parallelism, let&#39;s return back to our thread on scientific machine learning to start constructing parallel algorithms for integration of scientific models. We previously introduced discrete dynamical systems and their asymptotic behavior. However, many physical systems are not discrete and are in fact continuous. In this discussion we will understand how to numerically compute ordinary differential equations by transforming them into discrete dynamical systems, and use this to come up with simulation techniques for physical systems.</p> <h2>What is an Ordinary Differential Equation?</h2> <p>An ordinary differential equation is an equation defined by a relationship on the derivative. In its general form we have that</p> <p class=math >\[ u' = f(u,p,t) \]</p> <p>describes the evolution of some variable <span class=math >$u(t)$</span> which we would like to solve for. In its simplest sense, the solution to the ordinary differential equation is just the integral, since by taking the integral of both sides and applying the Fundamental Theorem of Calculus we have that</p> <p class=math >\[ u = \int_{t_0}^{t_f} f(u,p,t)dt \]</p> <p>The difficulty of this equation is that the variable <span class=math >$u(t)$</span> is unknown and dependent on <span class=math >$t$</span>, meaning that the integral cannot readily be solved by simple calculus. In fact, in almost all cases there exists no analytical solution for <span class=math >$u$</span> which is readily available. However, we can understand the behavior by looking at some simple cases.</p> <h2>Solving Ordinary Differential Equations in Julia</h2> <p>To solve an ordinary differential equation in Julia, one can use the <a href="http://docs.juliadiffeq.org/latest/">DifferentialEquations.jl</a> package to define the differential equation you&#39;d like to solve. Let&#39;s say we want to solve the Lorenz equations:</p> <p class=math >\[ \begin{align} \frac{dx}{dt} &= σ(y-x) \\ \frac{dy}{dt} &= x(ρ-z) - y \\ \frac{dz}{dt} &= xy - βz \\ \end{align} \]</p> <p>which was the system used in our investigation of discrete dynamics. The first thing we need to do is give it this differential equation. We can either write it in an in-place form <code>f&#40;du,u,p,t&#41;</code> or an out-of-place form <code>f&#40;u,p,t&#41;</code>. Let&#39;s write it in the in-place form:</p> <pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>lorenz</span><span class='hljl-p'>(</span><span class='hljl-n'>du</span><span class='hljl-p'>,</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
 </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'>
 </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>p</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>])</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
lorenz &#40;generic function with 3 methods&#41;
</pre> <p><strong>Question: How could I maybe speed this up a little?</strong></p> <p>Next we give an <em>initial condition</em>. Here, this is a vector of equations, so our initial condition has to be a vector. Let&#39;s choose the following initial condition:</p> <pre class='hljl'>
<span class='hljl-n'>u0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>]</span>
</pre> <pre class=output >
3-element Vector&#123;Float64&#125;:
 1.0
 0.0
 0.0
</pre> <p>Notice that I made sure to use <code>Float64</code> values in the initial condition. The Julia library&#39;s functions are generic and internally use the corresponding types that you give it. Integer types do not bode well for continuous problems.</p> <p>Next, we have to tell it the timespan to solve on. Here, let&#39;s some from time 0 to 100. This means that we would use:</p> <pre class='hljl'>
<span class='hljl-n'>tspan</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>100.0</span><span class='hljl-p'>)</span>
</pre> <pre class=output >
&#40;0.0, 100.0&#41;
</pre> <p>Now we need to define our parameters. We will use the same ones as from our discrete dynamical system investigation.</p> <pre class='hljl'>
<span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>10.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>28.0</span><span class='hljl-p'>,</span><span class='hljl-ni'>8</span><span class='hljl-oB'>/</span><span class='hljl-ni'>3</span><span class='hljl-p'>)</span>
</pre> <pre class=output >
&#40;10.0, 28.0, 2.6666666666666665&#41;
</pre> <p>These describe an <code>ODEProblem</code>. Let&#39;s bring in DifferentialEquations.jl and define the ODE:</p> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>DifferentialEquations</span><span class='hljl-t'>
</span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>lorenz</span><span class='hljl-p'>,</span><span class='hljl-n'>u0</span><span class='hljl-p'>,</span><span class='hljl-n'>tspan</span><span class='hljl-p'>,</span><span class='hljl-n'>p</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: Failed to precompile DifferentialEquations &#91;0c46a032-eb83-5123-abaf-570d42b7fbaa&#93; to &quot;/home/runner/.julia/compiled/v1.10/DifferentialEquations/jl_5gTBy9&quot;.
</pre> <p>Now we can solve it by calling <code>solve</code>:</p> <pre class='hljl'>
<span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;solve&#96; not defined
</pre> <p>To see what the solution looks like, we can call <code>plot</code>:</p> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: Failed to precompile Plots &#91;91a5bcdd-55d7-5caf-9e0b-520d859cae80&#93; to &quot;/home/runner/.julia/compiled/v1.10/Plots/jl_RIfhQ1&quot;.
</pre> <p>We can also plot phase space diagrams by telling it which <code>vars</code> to compare on which axis. Let&#39;s plot this in the <code>&#40;x,y,z&#41;</code> plane:</p> <pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>,</span><span class='hljl-n'>vars</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;plot&#96; not defined
</pre> <p>Note that the sentinal to time is <code>0</code>, so we can also do <code>&#40;t,y,z&#41;</code> with:</p> <pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>,</span><span class='hljl-n'>vars</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>3</span><span class='hljl-p'>))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;plot&#96; not defined
</pre> <p>The equation is continuous and therefore the solution is continuous. We can see this by checking how it is at any random time value:</p> <pre class='hljl'>
<span class='hljl-nf'>sol</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.5</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;sol&#96; not defined
</pre> <p>which gives the current evolution at that time point.</p> <h2>Differential Equations from Scientific Contexts</h2> <h3>N-Body Problems and Astronomy</h3> <p>There are many different contexts in which differential equations show up. In fact, it&#39;s not a stretch to say that the laws in all fields of science are encoded in differential equations. The starting point for physics is Newton&#39;s laws of gravity, which define an N-body ordinary differential equation system by describing the force between two particles as:</p> <p class=math >\[ F = G \frac{m_1m_2}{r^2} \]</p> <p>where <span class=math >$r^2$</span> is the Euclidean distance between the two particles. From here, we use the fact that</p> <p class=math >\[ F = ma \]</p> <p>to receive differential equations in terms of the accelerations of each particle. The differential equation is a system, where we know the change in position is due to the current velocity:</p> <p class=math >\[ x' = v \]</p> <p>and the change in velocity is the acceleration:</p> <p class=math >\[ v' = F/m = G \frac{m_i}{r_i^2} \]</p> <p>where <span class=math >$i$</span> runs over the other particles. Thus we have a vector of position derivatives and a vector of velocity derivatives that evolve over time to give the evolving positions and velocity.</p> <p>An example of this is the <a href="https://archimede.dm.uniba.it/~testset/report/plei.pdf">Pleiades problem</a>, which is an approximation to a 7-star chaotic system. It can be written as:</p> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>OrdinaryDiffEq</span><span class='hljl-t'>

</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>pleiades</span><span class='hljl-p'>(</span><span class='hljl-n'>du</span><span class='hljl-p'>,</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-nd'>@inbounds</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
  </span><span class='hljl-n'>x</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>view</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>7</span><span class='hljl-p'>)</span><span class='hljl-t'>   </span><span class='hljl-cs'># x</span><span class='hljl-t'>
  </span><span class='hljl-n'>y</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>view</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-ni'>8</span><span class='hljl-oB'>:</span><span class='hljl-ni'>14</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-cs'># y</span><span class='hljl-t'>
  </span><span class='hljl-n'>v</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>view</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-ni'>15</span><span class='hljl-oB'>:</span><span class='hljl-ni'>21</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># x′</span><span class='hljl-t'>
  </span><span class='hljl-n'>w</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>view</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-ni'>22</span><span class='hljl-oB'>:</span><span class='hljl-ni'>28</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># y′</span><span class='hljl-t'>
  </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>7</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>.=</span><span class='hljl-t'> </span><span class='hljl-n'>v</span><span class='hljl-t'>
  </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>8</span><span class='hljl-oB'>:</span><span class='hljl-ni'>14</span><span class='hljl-p'>]</span><span class='hljl-oB'>.=</span><span class='hljl-t'> </span><span class='hljl-n'>w</span><span class='hljl-t'>
  </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-ni'>15</span><span class='hljl-oB'>:</span><span class='hljl-ni'>28</span><span class='hljl-t'>
    </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zero</span><span class='hljl-p'>(</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>
  </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>7</span><span class='hljl-p'>,</span><span class='hljl-n'>j</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>7</span><span class='hljl-t'>
    </span><span class='hljl-k'>if</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>!=</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-t'>
      </span><span class='hljl-n'>r</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>((</span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-oB'>-</span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>j</span><span class='hljl-p'>])</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>j</span><span class='hljl-p'>])</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-oB'>^</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-oB'>/</span><span class='hljl-ni'>2</span><span class='hljl-p'>)</span><span class='hljl-t'>
      </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>14</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+=</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>j</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>x</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-oB'>/</span><span class='hljl-n'>r</span><span class='hljl-t'>
      </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>21</span><span class='hljl-oB'>+</span><span class='hljl-n'>i</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+=</span><span class='hljl-t'> </span><span class='hljl-n'>j</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>j</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>])</span><span class='hljl-oB'>/</span><span class='hljl-n'>r</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-n'>tspan</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>pleiades</span><span class='hljl-p'>,[</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>4.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>4.0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>1.75</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.5</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.25</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>],</span><span class='hljl-n'>tspan</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: Failed to precompile OrdinaryDiffEq &#91;1dea7af3-3e70-54e6-95c3-0bf5283fa5ed&#93; to &quot;/home/runner/.julia/compiled/v1.10/OrdinaryDiffEq/jl_dvyHCU&quot;.
</pre> <p>where we assume <span class=math >$m_i = i$</span>. When we solve this equation we receive the following:</p> <pre class='hljl'>
<span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-nf'>Vern8</span><span class='hljl-p'>(),</span><span class='hljl-n'>abstol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-10</span><span class='hljl-p'>,</span><span class='hljl-n'>reltol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-10</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;Vern8&#96; not defined
</pre> <pre class='hljl'>
<span class='hljl-n'>tspan</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>200.0</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>pleiades</span><span class='hljl-p'>,[</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>2.0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>4.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>4.0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>1.75</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.5</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-oB'>-</span><span class='hljl-nfB'>1.25</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>,</span><span class='hljl-ni'>0</span><span class='hljl-p'>],</span><span class='hljl-n'>tspan</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-nf'>Vern8</span><span class='hljl-p'>(),</span><span class='hljl-n'>abstol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-10</span><span class='hljl-p'>,</span><span class='hljl-n'>reltol</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1e-10</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>,</span><span class='hljl-n'>vars</span><span class='hljl-oB'>=</span><span class='hljl-p'>((</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>7</span><span class='hljl-p'>),(</span><span class='hljl-ni'>8</span><span class='hljl-oB'>:</span><span class='hljl-ni'>14</span><span class='hljl-p'>)))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;pleiades&#96; not defined
</pre> <h3>Population Ecology: Lotka-Volterra</h3> <p>Population ecology&#39;s starting point is the Lotka-Volterra equations which describes the interactions between a predator and a prey. In this case, the prey grows at an exponential rate but has a term that reduces its population by being eaten by the predator. The predator&#39;s growth is dependent on the available food &#40;the amount of prey&#41; and has a decay rate due to old age. This model is then written as follows:</p> <pre class='hljl'>
<span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>lotka</span><span class='hljl-p'>(</span><span class='hljl-n'>du</span><span class='hljl-p'>,</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
  </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>p</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>u</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nfB'>1.5</span><span class='hljl-p'>,</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>lotka</span><span class='hljl-p'>,[</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>],(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>10.0</span><span class='hljl-p'>),</span><span class='hljl-n'>p</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;ODEProblem&#96; not defined
</pre> <h3>Biochemistry: Robertson Equations</h3> <p>Biochemical equations commonly display large separation of timescales which lead to a stiffness phenomena that will be investigated later. The classic &quot;hard&quot; equations for ODE integration thus tend to come from biology &#40;not physics&#33;&#41; due to this property. One of the standard models is the Robertson model, which can be described as:</p> <pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Sundials</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ParameterizedFunctions</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>rober</span><span class='hljl-p'>(</span><span class='hljl-n'>du</span><span class='hljl-p'>,</span><span class='hljl-n'>u</span><span class='hljl-p'>,</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-n'>y₁</span><span class='hljl-p'>,</span><span class='hljl-n'>y₂</span><span class='hljl-p'>,</span><span class='hljl-n'>y₃</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>u</span><span class='hljl-t'>
  </span><span class='hljl-n'>k₁</span><span class='hljl-p'>,</span><span class='hljl-n'>k₂</span><span class='hljl-p'>,</span><span class='hljl-n'>k₃</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-t'>
  </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>k₁</span><span class='hljl-oB'>*</span><span class='hljl-n'>y₁</span><span class='hljl-oB'>+</span><span class='hljl-n'>k₃</span><span class='hljl-oB'>*</span><span class='hljl-n'>y₂</span><span class='hljl-oB'>*</span><span class='hljl-n'>y₃</span><span class='hljl-t'>
  </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-n'>k₁</span><span class='hljl-oB'>*</span><span class='hljl-n'>y₁</span><span class='hljl-oB'>-</span><span class='hljl-n'>k₂</span><span class='hljl-oB'>*</span><span class='hljl-n'>y₂</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-oB'>-</span><span class='hljl-n'>k₃</span><span class='hljl-oB'>*</span><span class='hljl-n'>y₂</span><span class='hljl-oB'>*</span><span class='hljl-n'>y₃</span><span class='hljl-t'>
  </span><span class='hljl-n'>du</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'>  </span><span class='hljl-n'>k₂</span><span class='hljl-oB'>*</span><span class='hljl-n'>y₂</span><span class='hljl-oB'>^</span><span class='hljl-ni'>2</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>rober</span><span class='hljl-p'>,[</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>],(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>1e5</span><span class='hljl-p'>),(</span><span class='hljl-nfB'>0.04</span><span class='hljl-p'>,</span><span class='hljl-nfB'>3e7</span><span class='hljl-p'>,</span><span class='hljl-nfB'>1e4</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-nf'>Rosenbrock23</span><span class='hljl-p'>())</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: Failed to precompile Sundials &#91;c3572dad-4567-51f8-b174-8c6c989267f4&#93; to &quot;/home/runner/.julia/compiled/v1.10/Sundials/jl_FGYGYx&quot;.
</pre> <pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xscale</span><span class='hljl-oB'>=:</span><span class='hljl-n'>log10</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>tspan</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e-6</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>1e5</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>layout</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;plot&#96; not defined
</pre> <h3>Chemical Physics: Pollution Models</h3> <p>Chemical reactions in physical models are also described as differential equation systems. The following is a classic model of dynamics between different species of pollutants:</p> <pre class='hljl'>
<span class='hljl-n'>k1</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.35e0</span><span class='hljl-t'>
</span><span class='hljl-n'>k2</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.266e2</span><span class='hljl-t'>
</span><span class='hljl-n'>k3</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.123e5</span><span class='hljl-t'>
</span><span class='hljl-n'>k4</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.86e-3</span><span class='hljl-t'>
</span><span class='hljl-n'>k5</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.82e-3</span><span class='hljl-t'>
</span><span class='hljl-n'>k6</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.15e5</span><span class='hljl-t'>
</span><span class='hljl-n'>k7</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.13e-3</span><span class='hljl-t'>
</span><span class='hljl-n'>k8</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.24e5</span><span class='hljl-t'>
</span><span class='hljl-n'>k9</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.165e5</span><span class='hljl-t'>
</span><span class='hljl-n'>k10</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.9e4</span><span class='hljl-t'>
</span><span class='hljl-n'>k11</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.22e-1</span><span class='hljl-t'>
</span><span class='hljl-n'>k12</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.12e5</span><span class='hljl-t'>
</span><span class='hljl-n'>k13</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.188e1</span><span class='hljl-t'>
</span><span class='hljl-n'>k14</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.163e5</span><span class='hljl-t'>
</span><span class='hljl-n'>k15</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.48e7</span><span class='hljl-t'>
</span><span class='hljl-n'>k16</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.35e-3</span><span class='hljl-t'>
</span><span class='hljl-n'>k17</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.175e-1</span><span class='hljl-t'>
</span><span class='hljl-n'>k18</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.1e9</span><span class='hljl-t'>
</span><span class='hljl-n'>k19</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.444e12</span><span class='hljl-t'>
</span><span class='hljl-n'>k20</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.124e4</span><span class='hljl-t'>
</span><span class='hljl-n'>k21</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.21e1</span><span class='hljl-t'>
</span><span class='hljl-n'>k22</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.578e1</span><span class='hljl-t'>
</span><span class='hljl-n'>k23</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.474e-1</span><span class='hljl-t'>
</span><span class='hljl-n'>k24</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.178e4</span><span class='hljl-t'>
</span><span class='hljl-n'>k25</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>.312e1</span><span class='hljl-t'>
</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>k1</span><span class='hljl-p'>,</span><span class='hljl-n'>k2</span><span class='hljl-p'>,</span><span class='hljl-n'>k3</span><span class='hljl-p'>,</span><span class='hljl-n'>k4</span><span class='hljl-p'>,</span><span class='hljl-n'>k5</span><span class='hljl-p'>,</span><span class='hljl-n'>k6</span><span class='hljl-p'>,</span><span class='hljl-n'>k7</span><span class='hljl-p'>,</span><span class='hljl-n'>k8</span><span class='hljl-p'>,</span><span class='hljl-n'>k9</span><span class='hljl-p'>,</span><span class='hljl-n'>k10</span><span class='hljl-p'>,</span><span class='hljl-n'>k11</span><span class='hljl-p'>,</span><span class='hljl-n'>k12</span><span class='hljl-p'>,</span><span class='hljl-n'>k13</span><span class='hljl-p'>,</span><span class='hljl-n'>k14</span><span class='hljl-p'>,</span><span class='hljl-n'>k15</span><span class='hljl-p'>,</span><span class='hljl-n'>k16</span><span class='hljl-p'>,</span><span class='hljl-n'>k17</span><span class='hljl-p'>,</span><span class='hljl-n'>k18</span><span class='hljl-p'>,</span><span class='hljl-n'>k19</span><span class='hljl-p'>,</span><span class='hljl-n'>k20</span><span class='hljl-p'>,</span><span class='hljl-n'>k21</span><span class='hljl-p'>,</span><span class='hljl-n'>k22</span><span class='hljl-p'>,</span><span class='hljl-n'>k23</span><span class='hljl-p'>,</span><span class='hljl-n'>k24</span><span class='hljl-p'>,</span><span class='hljl-n'>k25</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>function</span><span class='hljl-t'> </span><span class='hljl-nf'>f</span><span class='hljl-p'>(</span><span class='hljl-n'>dy</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-t'>
 </span><span class='hljl-n'>k1</span><span class='hljl-p'>,</span><span class='hljl-n'>k2</span><span class='hljl-p'>,</span><span class='hljl-n'>k3</span><span class='hljl-p'>,</span><span class='hljl-n'>k4</span><span class='hljl-p'>,</span><span class='hljl-n'>k5</span><span class='hljl-p'>,</span><span class='hljl-n'>k6</span><span class='hljl-p'>,</span><span class='hljl-n'>k7</span><span class='hljl-p'>,</span><span class='hljl-n'>k8</span><span class='hljl-p'>,</span><span class='hljl-n'>k9</span><span class='hljl-p'>,</span><span class='hljl-n'>k10</span><span class='hljl-p'>,</span><span class='hljl-n'>k11</span><span class='hljl-p'>,</span><span class='hljl-n'>k12</span><span class='hljl-p'>,</span><span class='hljl-n'>k13</span><span class='hljl-p'>,</span><span class='hljl-n'>k14</span><span class='hljl-p'>,</span><span class='hljl-n'>k15</span><span class='hljl-p'>,</span><span class='hljl-n'>k16</span><span class='hljl-p'>,</span><span class='hljl-n'>k17</span><span class='hljl-p'>,</span><span class='hljl-n'>k18</span><span class='hljl-p'>,</span><span class='hljl-n'>k19</span><span class='hljl-p'>,</span><span class='hljl-n'>k20</span><span class='hljl-p'>,</span><span class='hljl-n'>k21</span><span class='hljl-p'>,</span><span class='hljl-n'>k22</span><span class='hljl-p'>,</span><span class='hljl-n'>k23</span><span class='hljl-p'>,</span><span class='hljl-n'>k24</span><span class='hljl-p'>,</span><span class='hljl-n'>k25</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-t'>
 </span><span class='hljl-n'>r1</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k1</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r2</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k2</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r3</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k3</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>5</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r4</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k4</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>7</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r5</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k5</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>7</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r6</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k6</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>7</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>6</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r7</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k7</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>9</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r8</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k8</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>9</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>6</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r9</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k9</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>11</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r10</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k10</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>11</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r11</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k11</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>13</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r12</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k12</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>10</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r13</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k13</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>14</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r14</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k14</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>6</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r15</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k15</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r16</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k16</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r17</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k17</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r18</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k18</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>16</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r19</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k19</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>16</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r20</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k20</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>17</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>6</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r21</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k21</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>19</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r22</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k22</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>19</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r23</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k23</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r24</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k24</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>19</span><span class='hljl-p'>]</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
 </span><span class='hljl-n'>r25</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>k25</span><span class='hljl-oB'>*</span><span class='hljl-n'>y</span><span class='hljl-p'>[</span><span class='hljl-ni'>20</span><span class='hljl-p'>]</span><span class='hljl-t'>

 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r1</span><span class='hljl-oB'>-</span><span class='hljl-n'>r10</span><span class='hljl-oB'>-</span><span class='hljl-n'>r14</span><span class='hljl-oB'>-</span><span class='hljl-n'>r23</span><span class='hljl-oB'>-</span><span class='hljl-n'>r24</span><span class='hljl-oB'>+</span><span class='hljl-t'>
          </span><span class='hljl-n'>r2</span><span class='hljl-oB'>+</span><span class='hljl-n'>r3</span><span class='hljl-oB'>+</span><span class='hljl-n'>r9</span><span class='hljl-oB'>+</span><span class='hljl-n'>r11</span><span class='hljl-oB'>+</span><span class='hljl-n'>r12</span><span class='hljl-oB'>+</span><span class='hljl-n'>r22</span><span class='hljl-oB'>+</span><span class='hljl-n'>r25</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r2</span><span class='hljl-oB'>-</span><span class='hljl-n'>r3</span><span class='hljl-oB'>-</span><span class='hljl-n'>r9</span><span class='hljl-oB'>-</span><span class='hljl-n'>r12</span><span class='hljl-oB'>+</span><span class='hljl-n'>r1</span><span class='hljl-oB'>+</span><span class='hljl-n'>r21</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>3</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r15</span><span class='hljl-oB'>+</span><span class='hljl-n'>r1</span><span class='hljl-oB'>+</span><span class='hljl-n'>r17</span><span class='hljl-oB'>+</span><span class='hljl-n'>r19</span><span class='hljl-oB'>+</span><span class='hljl-n'>r22</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r2</span><span class='hljl-oB'>-</span><span class='hljl-n'>r16</span><span class='hljl-oB'>-</span><span class='hljl-n'>r17</span><span class='hljl-oB'>-</span><span class='hljl-n'>r23</span><span class='hljl-oB'>+</span><span class='hljl-n'>r15</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>5</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r3</span><span class='hljl-oB'>+</span><span class='hljl-n'>r4</span><span class='hljl-oB'>+</span><span class='hljl-n'>r4</span><span class='hljl-oB'>+</span><span class='hljl-n'>r6</span><span class='hljl-oB'>+</span><span class='hljl-n'>r7</span><span class='hljl-oB'>+</span><span class='hljl-n'>r13</span><span class='hljl-oB'>+</span><span class='hljl-n'>r20</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>6</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r6</span><span class='hljl-oB'>-</span><span class='hljl-n'>r8</span><span class='hljl-oB'>-</span><span class='hljl-n'>r14</span><span class='hljl-oB'>-</span><span class='hljl-n'>r20</span><span class='hljl-oB'>+</span><span class='hljl-n'>r3</span><span class='hljl-oB'>+</span><span class='hljl-n'>r18</span><span class='hljl-oB'>+</span><span class='hljl-n'>r18</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>7</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r4</span><span class='hljl-oB'>-</span><span class='hljl-n'>r5</span><span class='hljl-oB'>-</span><span class='hljl-n'>r6</span><span class='hljl-oB'>+</span><span class='hljl-n'>r13</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>8</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r4</span><span class='hljl-oB'>+</span><span class='hljl-n'>r5</span><span class='hljl-oB'>+</span><span class='hljl-n'>r6</span><span class='hljl-oB'>+</span><span class='hljl-n'>r7</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>9</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r7</span><span class='hljl-oB'>-</span><span class='hljl-n'>r8</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>10</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r12</span><span class='hljl-oB'>+</span><span class='hljl-n'>r7</span><span class='hljl-oB'>+</span><span class='hljl-n'>r9</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>11</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r9</span><span class='hljl-oB'>-</span><span class='hljl-n'>r10</span><span class='hljl-oB'>+</span><span class='hljl-n'>r8</span><span class='hljl-oB'>+</span><span class='hljl-n'>r11</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>12</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r9</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>13</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r11</span><span class='hljl-oB'>+</span><span class='hljl-n'>r10</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>14</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r13</span><span class='hljl-oB'>+</span><span class='hljl-n'>r12</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>15</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r14</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>16</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r18</span><span class='hljl-oB'>-</span><span class='hljl-n'>r19</span><span class='hljl-oB'>+</span><span class='hljl-n'>r16</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>17</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r20</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>18</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r20</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>19</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r21</span><span class='hljl-oB'>-</span><span class='hljl-n'>r22</span><span class='hljl-oB'>-</span><span class='hljl-n'>r24</span><span class='hljl-oB'>+</span><span class='hljl-n'>r23</span><span class='hljl-oB'>+</span><span class='hljl-n'>r25</span><span class='hljl-t'>
 </span><span class='hljl-n'>dy</span><span class='hljl-p'>[</span><span class='hljl-ni'>20</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-n'>r25</span><span class='hljl-oB'>+</span><span class='hljl-n'>r24</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre> <pre class=output >
f &#40;generic function with 2 methods&#41;
</pre> <pre class='hljl'>
<span class='hljl-n'>u0</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-ni'>20</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>u0</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.2</span><span class='hljl-t'>
</span><span class='hljl-n'>u0</span><span class='hljl-p'>[</span><span class='hljl-ni'>4</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.04</span><span class='hljl-t'>
</span><span class='hljl-n'>u0</span><span class='hljl-p'>[</span><span class='hljl-ni'>7</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.1</span><span class='hljl-t'>
</span><span class='hljl-n'>u0</span><span class='hljl-p'>[</span><span class='hljl-ni'>8</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.3</span><span class='hljl-t'>
</span><span class='hljl-n'>u0</span><span class='hljl-p'>[</span><span class='hljl-ni'>9</span><span class='hljl-p'>]</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.01</span><span class='hljl-t'>
</span><span class='hljl-n'>u0</span><span class='hljl-p'>[</span><span class='hljl-ni'>17</span><span class='hljl-p'>]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.007</span><span class='hljl-t'>
</span><span class='hljl-n'>prob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>f</span><span class='hljl-p'>,</span><span class='hljl-n'>u0</span><span class='hljl-p'>,(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>60.0</span><span class='hljl-p'>),</span><span class='hljl-n'>p</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>prob</span><span class='hljl-p'>,</span><span class='hljl-nf'>Rodas5</span><span class='hljl-p'>())</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;ODEProblem&#96; not defined
</pre> <pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>)</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;plot&#96; not defined
</pre> <pre class='hljl'>
<span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>sol</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xscale</span><span class='hljl-oB'>=:</span><span class='hljl-n'>log10</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>tspan</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1e-6</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>60</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>layout</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span>
</pre> <pre class=julia-error >
ERROR: UndefVarError: &#96;plot&#96; not defined
</pre> <h2>Geometric Properties</h2> <h3>Linear Ordinary Differential Equations</h3> <p>The simplest ordinary differential equation is the scalar linear ODE, which is given in the form</p> <p class=math >\[ u' = \alpha u \]</p> <p>We can solve this by noticing that <span class=math >$(e^{\alpha t})^\prime = \alpha e^{\alpha t}$</span> satisfies the differential equation and thus the general solution is:</p> <p class=math >\[ u(t) = u(0)e^{\alpha t} \]</p> <p>From the analytical solution we have that:</p> <ul> <li><p>If <span class=math >$Re(\alpha) > 0$</span> then <span class=math >$u(t) \rightarrow \infty$</span> as <span class=math >$t \rightarrow \infty$</span></p> <li><p>If <span class=math >$Re(\alpha) < 0$</span> then <span class=math >$u(t) \rightarrow 0$</span> as <span class=math >$t \rightarrow \infty$</span></p> <li><p>If <span class=math >$Re(\alpha) = 0$</span> then <span class=math >$u(t)$</span> has a constant or periodic solution.</p> </ul> <p>This theory can then be extended to multivariable systems in the same way as the discrete dynamics case. Let <span class=math >$u$</span> be a vector and have</p> <p class=math >\[ u' = Au \]</p> <p>be a linear ordinary differential equation. Assuming <span class=math >$A$</span> is diagonalizable, we diagonalize <span class=math >$A = P^{-1}DP$</span> to get</p> <p class=math >\[ Pu' = DPu \]</p> <p>and change coordinates <span class=math >$z = Pu$</span> so that we have</p> <p class=math >\[ z' = Dz \]</p> <p>which decouples the equation into a system of linear ordinary differential equations which we solve individually. Thus we see that, similarly to the discrete dynamical system, we have that:</p> <ul> <li><p>If all of the eigenvalues negative, then <span class=math >$u(t) \rightarrow 0$</span> as <span class=math >$t \rightarrow \infty$</span></p> <li><p>If any eigenvalue is positive, then <span class=math >$u(t) \rightarrow \infty$</span> as <span class=math >$t \rightarrow \infty$</span></p> </ul> <h3>Nonlinear Ordinary Differential Equations</h3> <p>As with discrete dynamical systems, the geometric properties extend locally to the linearization of the continuous dynamical system as defined by:</p> <p class=math >\[ u' = \frac{df}{du} u \]</p> <p>where <span class=math >$\frac{df}{du}$</span> is the Jacobian of the system. This is a consequence of the Hartman-Grubman Theorem.</p> <h2>Numerically Solving Ordinary Differential Equations</h2> <h3>Euler&#39;s Method</h3> <p>To numerically solve an ordinary differential equation, one turns the continuous equation into a discrete equation by <em>discretizing</em> it. The simplest discretization is the <em>Euler method</em>. The Euler method can be thought of as a simple approximation replacing <span class=math >$dt$</span> with a small non-infinitesimal <span class=math >$\Delta t$</span>. Thus we can approximate</p> <p class=math >\[ f(u,p,t) = u' = \frac{du}{dt} \approx \frac{\Delta u}{\Delta t} \]</p> <p>and now since <span class=math >$\Delta u = u_{n+1} - u_n$</span> we have that</p> <p class=math >\[ \Delta t f(u,p,t) = u_{n+1} - u_n \]</p> <p>We need to make a choice as to where we evaluate <span class=math >$f$</span> at. The simplest approximation is to evaluate it at <span class=math >$t_n$</span> with <span class=math >$u_n$</span> where we already have the data, and thus we re-arrange to get</p> <p class=math >\[ u_{n+1} = u_n + \Delta t f(u,p,t) \]</p> <p>This is the Euler method.</p> <p>We can interpret it more rigorously by looking at the Taylor series expansion. First write out the Taylor series for the ODE&#39;s solution in the near future:</p> <p class=math >\[ u(t+\Delta t) = u(t) + \Delta t u'(t) + \frac{\Delta t^2}{2} u''(t) + \ldots \]</p> <p>Recall that <span class=math >$u' = f(u,p,t)$</span> by the definition of the ODE system, and thus we have that</p> <p class=math >\[ u(t+\Delta t) = u(t) + \Delta t f(u,p,t) + \mathcal{O}(\Delta t^2) \]</p> <p>This is a first order approximation because the error in our step can be expressed as an error in the derivative, i.e.</p> <p class=math >\[ \frac{u(t + \Delta t) - u(t)}{\Delta t} = f(u,p,t) + \mathcal{O}(\Delta t) \]</p> <h3>Higher Order Methods</h3> <p>We can use this analysis to extend our methods to higher order approximation by simply matching the Taylor series to a higher order. Intuitively, when we developed the Euler method we had to make a choice:</p> <p class=math >\[ u_{n+1} = u_n + \Delta t f(u,p,t) \]</p> <p>where do we evaluate <span class=math >$f$</span>? One may think that the best derivative approximation my come from the middle of the interval, in which case we might want to evaluate it at <span class=math >$t + \frac{\Delta t}{2}$</span>. To do so, we can use the Euler method to approximate the value at <span class=math >$t + \frac{\Delta t}{2}$</span> and then use that value to approximate the derivative at <span class=math >$t + \frac{\Delta t}{2}$</span>. This looks like:</p> <p class=math >\[ k_1 = f(u_n,p,t)\\ k_2 = f(u_n + \frac{\Delta t}{2} k_1,p,t + \frac{\Delta t}{2})\\ u_{n+1} = u_n + \Delta t k_2 \]</p> <p>which we can also write as:</p> <p class=math >\[ u_{n+1} = u_n + \Delta t f(u_n + \frac{\Delta t}{2} f_n,p,t + \frac{\Delta t}{2}) \]</p> <p>where <span class=math >$f_n = f(u_n,p,t)$</span>. If we do the two-dimensional Taylor expansion we get:</p> <p class=math >\[ u_{n+1} = u_n + \Delta t f_n + \frac{\Delta t^2}{2}(f_t + f_u f)(u_n,p,t)\\ + \frac{\Delta t^3}{6} (f_{tt} + 2f_{tu}f + f_{uu}f^2)(u_n,p,t) \]</p> <p>which when we compare against the true Taylor series:</p> <p class=math >\[ u(t+\Delta t) = u_n + \Delta t f(u_n,p,t) + \frac{\Delta t^2}{2}(f_t + f_u f)(u_n,p,t) + \frac{\Delta t^3}{6}(f_{tt} + 2f_{tu} + f_{uu}f^2 + f_t f_u + f_u^2 f)(u_n,p,t) \]</p> <p>and thus we see that</p> <p class=math >\[ u(t + \Delta t) - u_n = \mathcal{O}(\Delta t^3) \]</p> <h3>Runge-Kutta Methods</h3> <p>More generally, Runge-Kutta methods are of the form:</p> <p class=math >\[ k_1 = f(u_n,p,t)\\ k_2 = f(u_n + \Delta t (a_{21} k_1),p,t + \Delta t c_2)\\ k_3 = f(u_n + \Delta t (a_{31} k_1 + a_{32} k_2),p,t + \Delta t c_3)\\ \vdots \\ u_{n+1} = u_n + \Delta t (b_1 k_1 + \ldots + b_s k_s) \]</p> <p>where <span class=math >$s$</span> is the number of stages. These can be expressed as a tableau:</p> <p><img src="https://en.wikipedia.org/wiki/List_of_Runge&#37;E2&#37;80&#37;93Kutta_methods" alt="" /></p> <p>The order of the Runge-Kutta method is simply the number of terms in the Taylor series that ends up being matched by the resulting expansion. For example, for the 4th order you can expand out and see that the following equations need to be satisfied:</p> <p><img src="https://user-images.githubusercontent.com/1814174/95117136-105ae780-0716-11eb-9f6a-49fecf7adbeb.PNG" alt="" /></p> <p>The classic Runge-Kutta method is also known as RK4 and is the following 4th order method:</p> <p class=math >\[ k_1 = f(u_n,p,t)\\ k_2 = f(u_n + \frac{\Delta t}{2} k_1,p,t + \frac{\Delta t}{2})\\ k_3 = f(u_n + \frac{\Delta t}{2} k_2,p,t + \frac{\Delta t}{2})\\ k_4 = f(u_n + \Delta t k_3,p,t + \Delta t)\\ u_{n+1} = u_n + \frac{\Delta t}{6}(k_1 + 2 k_2 + 2 k_3 + k_4)\\ \]</p> <p>While it&#39;s widely known and simple to remember, it&#39;s not necessarily good. The way to judge a Runge-Kutta method is by looking at the size of the coefficient of the next term in the Taylor series: if it&#39;s large then the true error can be larger, even if it matches another one asymptotically.</p> <h2>What Makes a Good Method?</h2> <h3>Leading Truncation Coefficients</h3> <p>For given orders of explicit Runge-Kutta methods, lower bounds for the number of <code>f</code> evaluations &#40;stages&#41; required to receive a given order are known:</p> <p><img src="https://user-images.githubusercontent.com/1814174/95117078-f8836380-0715-11eb-9acf-0626338307d1.PNG" alt="" /></p> <p>While unintuitive, using the method is not necessarily the one that reduces the coefficient the most. The reason is because what is attempted in ODE solving is precisely the opposite of the analysis. In the ODE analysis, we&#39;re looking at behavior as <span class=math >$\Delta t \rightarrow 0$</span>. However, when efficiently solving ODEs, we want to use the largest <span class=math >$\Delta t$</span> which satisfies error tolerances.</p> <p>The most widely used method is the Dormand-Prince 5th order Runge-Kutta method, whose tableau is represented as:</p> <p><img src="http://rotordynamics.files.wordpress.com/2014/05/new-picture6.png" alt="" /></p> <p>Notice that this method takes 7 calls to <code>f</code> for 5th order. The key to this method is that it has optimized leading truncation error coefficients, under some extra assumptions which allow for the analysis to be simplified.</p> <h3>Looking at the Effects of RK Method Choices and Code Optimizations</h3> <p>Pulling from the <a href="https://github.com/SciML/SciMLBenchmarks.jl">SciML Benchmarks</a>, we can see the general effect of these different properties on a given set of Runge-Kutta methods:</p> <p><img src="https://user-images.githubusercontent.com/1814174/95118000-7c8a1b00-0717-11eb-8080-2179da500cd2.PNG" alt="" /></p> <p>Here, the order of the method is given in the name. We can see one immediate factor is that, as the requested error in the calculation decreases, the higher order methods become more efficient. This is because to decrease error, you decrease <span class=math >$\Delta t$</span>, and thus the exponent difference with respect to <span class=math >$\Delta t$</span> has more of a chance to pay off for the extra calls to <code>f</code>. Additionally, we can see that order is not the only determining factor for efficiency: the Vern8 method seems to have a clear approximate 2.5x performance advantage over the whole span of the benchmark compared to the DP8 method, even though both are 8th order methods. This is because of the leading truncation terms: with a small enough <span class=math >$\Delta t$</span>, the more optimized method &#40;Vern8&#41; will generally have low error in a step for the same <span class=math >$\Delta t$</span> because the coefficients in the expansion are generally smaller.</p> <p>This is a factor which is generally ignored in high level discussions of numerical differential equations, but can lead to orders of magnitude differences&#33; This is highlighted in the following plot:</p> <p><img src="https://user-images.githubusercontent.com/1814174/95118457-544eec00-0718-11eb-8c19-f402e2cb8842.PNG" alt="" /></p> <p>Here we see ODEInterface.jl&#39;s ODEInterfaceDiffEq.jl wrapper into the SciML common interface for the standard <code>dopri</code> method from Fortran, and ODE.jl, the original ODE solvers in Julia, have a performance disadvantage compared to the DifferentialEquations.jl methods due in part to some of the coding performance pieces that we discussed in the first few lectures.</p> <p>Specifically, a large part of this can be attributed to inlining of the higher order functions, i.e. ODEs are defined by a user function and then have to be called from the solver. If the solver code is compiled as a shared library ahead of time, like is commonly done in C&#43;&#43; or Fortran, then there can be a function call overhead that is eliminated by JIT compilation optimizing across the function call barriers &#40;known as interprocedural optimization&#41;. This is one way which a JIT system can outperform an AOT &#40;ahead of time&#41; compiled system in real-world code &#40;for completeness, two other ways are by doing full function specialization, which is something that is <a href="https://scalac.io/specialized-generics-object-instantiation/">not generally possible in AOT languages given that you cannot know all types ahead of time for a fully generic function</a>, and <a href="https://github.com/dyu/ffi-overhead#results-500m-calls">calling C itself, i.e. c-ffi &#40;foreign function interface&#41;, can be optimized using the runtime information of the JIT compiler to outperform C&#33;</a>&#41;.</p> <p>The other performance difference being shown here is due to optimization of the method. While a slightly different order, we can see a clear difference in the performance of RK4 vs the coefficient optimized methods. It&#39;s about the same order of magnitude as &quot;highly optimized code differences&quot;, showing that both the Runge-Kutta coefficients and the code implementation can have a significant impact on performance.</p> <p>Taking a look at what happens when interpreted languages get involved highlights some of the code challenges in this domain. Let&#39;s take a look at for example the results when simulating 3 ODE systems with the various RK methods:</p> <p><img src="https://user-images.githubusercontent.com/1814174/95131785-b1549d00-072c-11eb-8d2a-490f69a4b99f.PNG" alt="" /></p> <p>We see that using interpreted languages introduces around a 50x-100x performance penalty. If you recall in your previous lecture, the discrete dynamical system that was being simulated was the 3-dimensional Lorenz equation discretized by Euler&#39;s method, meaning that the performance of that implementation is a good proxy for understanding the performance differences in this graph. Recall that in previous lectures we saw an approximately 5x performance advantage when specializing on the system function and size and around 10x by reducing allocations: these features account for the performance differences noticed between library implementations, which are then compounded by the use of different RK methods &#40;note that R uses &quot;call by copy&quot; which even further increases the memory usages and makes standard usage of the language incompatible with mutating function calls&#33;&#41;.</p> <h3>Stability of a Method</h3> <p>Simply having an order on the truncation error does not imply convergence of the method. The disconnect is that the errors at a given time point may not dissipate. What also needs to be checked is the asymptotic behavior of a disturbance. To see this, one can utilize the linear test problem:</p> <p class=math >\[ u' = \alpha u \]</p> <p>and ask the question, does the discrete dynamical system defined by the discretized ODE end up going to zero? You would hope that the discretized dynamical system and the continuous dynamical system have the same properties in this simple case, and this is known as linear stability analysis of the method.</p> <p>As an example, take a look at the Euler method. Recall that the Euler method was given by:</p> <p class=math >\[ u_{n+1} = u_n + \Delta t f(u_n,p,t) \]</p> <p>When we plug in the linear test equation, we get that</p> <p class=math >\[ u_{n+1} = u_n + \Delta t \alpha u_n \]</p> <p>If we let <span class=math >$z = \Delta t \alpha$</span>, then we get the following:</p> <p class=math >\[ u_{n+1} = u_n + z u_n = (1+z)u_n \]</p> <p>which is stable when <span class=math >$z$</span> is in the shifted unit circle. This means that, as a necessary condition, the step size <span class=math >$\Delta t$</span> needs to be small enough that <span class=math >$z$</span> satisfies this condition, placing a stepsize limit on the method.</p> <p><img src="https://user-images.githubusercontent.com/1814174/95117231-3c766880-0716-11eb-9069-039253bcebda.PNG" alt="" /></p> <p>If <span class=math >$\Delta t$</span> is ever too large, it will cause the equation to overshoot zero, which then causes oscillations that spiral out to infinity.</p> <p><img src="https://user-images.githubusercontent.com/1814174/95132604-0d6bf100-072e-11eb-8af5-663512a0db14.PNG" alt="" /></p> <p><img src="https://user-images.githubusercontent.com/1814174/95132963-9125dd80-072e-11eb-878e-61f77a20d03e.gif" alt="" /></p> <p>Thus the stability condition places a hard constraint on the allowed <span class=math >$\Delta t$</span> which will result in a realistic simulation.</p> <p>For reference, the stability regions of the 2nd and 4th order Runge-Kutta methods that we discussed are as follows:</p> <p><img src="https://user-images.githubusercontent.com/1814174/95117286-56b04680-0716-11eb-9c6a-07fc4d190a09.PNG" alt="" /></p> <h3>Interpretation of the Linear Stability Condition</h3> <p>To interpret the linear stability condition, recall that the linearization of a system interprets the dynamics as locally being due to the Jacobian of the system. Thus</p> <p class=math >\[ u' = f(u,p,t) \]</p> <p>is locally equivalent to</p> <p class=math >\[ u' = \frac{df}{du}u \]</p> <p>You can understand the local behavior through diagonalizing this matrix. Therefore, the scalar for the linear stability analysis is performing an analysis on the eigenvalues of the Jacobian. The method will be stable if the largest eigenvalues of df/du are all within the stability limit. This means that stability effects are different throughout the solution of a nonlinear equation and are generally understood locally &#40;though different more comprehensive stability conditions exist&#33;&#41;.</p> <h3>Implicit Methods</h3> <p>If instead of the Euler method we defined <span class=math >$f$</span> to be evaluated at the future point, we would receive a method like:</p> <p class=math >\[ u_{n+1} = u_n + \Delta t f(u_{n+1},p,t+\Delta t) \]</p> <p>in which case, for the stability calculation we would have that</p> <p class=math >\[ u_{n+1} = u_n + \Delta t \alpha u_n \]</p> <p>or</p> <p class=math >\[ (1-z) u_{n+1} = u_n \]</p> <p>which means that</p> <p class=math >\[ u_{n+1} = \frac{1}{1-z} u_n \]</p> <p>which is stable for all <span class=math >$Re(z) < 0$</span> a property which is known as A-stability. It is also stable as <span class=math >$z \rightarrow \infty$</span>, a property known as L-stability. This means that for equations with very ill-conditioned Jacobians, this method is still able to be use reasonably large stepsizes and can thus be efficient.</p> <p><img src="https://user-images.githubusercontent.com/1814174/95117191-28326b80-0716-11eb-8e17-889308bdff53.PNG" alt="" /></p> <h3>Stiffness and Timescale Separation</h3> <p>From this we see that there is a maximal stepsize whenever the eigenvalues of the Jacobian are sufficiently large. It turns out that&#39;s not an issue if the phenomena we see are fast, since then the total integration time tends to be small. However, if we have some equations with both fast modes and slow modes, like the Robertson equation, then it is very difficult because in order to resolve the slow dynamics over a long timespan, one needs to ensure that the fast dynamics do not diverge. This is a property known as stiffness. Stiffness can thus be approximated in some sense by the condition number of the Jacobian. The condition number of a matrix is its maximal eigenvalue divided by its minimal eigenvalue and gives a rough measure of the local timescale separations. If this value is large and one wants to resolve the slow dynamics, then explicit integrators, like the explicit Runge-Kutta methods described before, have issues with stability. In this case implicit integrators &#40;or other forms of stabilized stepping&#41; are required in order to efficiently reach the end time step.</p> <p><img src="https://user-images.githubusercontent.com/1814174/95132552-f6c59a00-072d-11eb-881e-24364b7b728f.PNG" alt="" /></p> <h2>Exploiting Continuity</h2> <p>So far, we have looked at ordinary differential equations as a <span class=math >$\Delta t \rightarrow 0$</span> formulation of a discrete dynamical system. However, continuous dynamics and discrete dynamics have very different characteristics which can be utilized in order to arrive at simpler models and faster computations.</p> <h3>Geometric Properties: No Jumping and the Poincaré–Bendixson theorem</h3> <p>In terms of geometric properties, continuity places a large constraint on the possible dynamics. This is because of the physical constraint on &quot;jumping&quot;, i.e. flows of differential equations cannot jump over each other. If you are ever at some point in phase space and <span class=math >$f$</span> is not explicitly time-dependent, then the direction of <span class=math >$u'$</span> is uniquely determined &#40;given reasonable assumptions on <span class=math >$f$</span>&#41;, meaning that flow lines &#40;solutions to the differential equation&#41; can never cross.</p> <p>A result from this is the Poincaré–Bendixson theorem, which states that, with any arbitrary &#40;but nice&#41; two dimensional continuous system, you can only have 3 behaviors:</p> <ul> <li><p>Steady state behavior</p> <li><p>Divergence</p> <li><p>Periodic orbits</p> </ul> <p>A simple proof by picture shows this.</p> <div class=footer > <p> Published from <a href=discretizing_odes.jmd >discretizing_odes.jmd</a> using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.9 on 2024-04-09. </p> </div>